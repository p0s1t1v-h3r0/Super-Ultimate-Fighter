<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Super Ultimate Fighter</title>
<style>
body {
  background:#111;
  color:#eee;
  font-family: monospace;
  padding:20px;
}
button {
  margin:4px;
  padding:8px;
  background:#222;
  color:#eee;
  border:1px solid #555;
  cursor:pointer;
}
button:hover { background:#333; }
#log {
  border:1px solid #444;
  padding:10px;
  height:300px;
  overflow-y:auto;
  background:#000;
}
.stat {
  margin-bottom:6px;
}
</style>
</head>
<body>

<h1>Super Ultimate Fighter (Prototype)</h1>

<div class="stat" id="status"></div>
<div class="stat" id="range"></div>
<div class="stat" id="stance"></div>
<div class="stat" id="timer"></div>

<h3>Actions</h3>
<div id="actions"></div>

<h3>Combat Log</h3>
<div id="log"></div>

<script>
// ---------------- CORE DATA ----------------

const RANGES = ["Kickboxing", "Boxing", "Clinch", "Ground"];
const STANCES = ["Orthodox", "Southpaw"];

function createFighter(name) {
  return {
    name,
    stance: Math.random() > 0.5 ? "Orthodox" : "Southpaw",
    range: "Boxing",
    stamina: 100,
    balance: 100,
    delay: 0,
    buffs: {},
    limbs: {
      head: 100,
      torso: 100,
      leftArm: 100,
      rightArm: 100,
      leftLeg: 100,
      rightLeg: 100
    }
  };
}

let player = createFighter("You");
let enemy = createFighter("Opponent");

let turnStart = Date.now();
let logEl = document.getElementById("log");

// ---------------- UTILS ----------------

function log(text) {
  logEl.innerHTML += text + "<br>";
  logEl.scrollTop = logEl.scrollHeight;
}

function injuryDesc(value, part) {
  if (value > 75) return `${part} looks fine.`;
  if (value > 50) return `${part} is bruised.`;
  if (value > 25) return `${part} looks painful to use.`;
  if (value > 10) return `${part} is badly compromised.`;
  return `${part} is nearly unusable.`;
}

function staminaDesc(v) {
  if (v > 75) return "Breathing steady.";
  if (v > 50) return "Breathing heavier.";
  if (v > 25) return "Labored breathing.";
  if (v > 10) return "Gasping for air.";
  return "On the verge of collapse.";
}

// ---------------- MOVE DEFINITIONS ----------------

const MOVES = {
  jab: {
    name: "Jab",
    stamina: 5,
    accuracy: 0.8,
    damage: 8,
    delay: 1,
    range: ["Boxing"],
    risk: "Low"
  },
  cross: {
    name: "Cross",
    stamina: 8,
    accuracy: 0.7,
    damage: 14,
    delay: 2,
    range: ["Boxing"],
    risk: "Medium"
  },
  heavyKick: {
    name: "Heavy Kick",
    stamina: 15,
    accuracy: 0.5,
    damage: 25,
    delay: 4,
    balanceRisk: 15,
    range: ["Kickboxing"],
    risk: "High"
  },
  clinch: {
    name: "Enter Clinch",
    stamina: 10,
    accuracy: 0.7,
    delay: 2,
    rangeChange: "Clinch"
  },
  focus: {
    name: "Sharpen Focus",
    stamina: 6,
    delay: 1,
    buff: { accuracy: 0.15, turns: 3 }
  },
  pokerFace: {
    name: "Poker Face",
    stamina: 5,
    delay: 1,
    buff: { conceal: true, turns: 3 }
  },
  dodge: {
    name: "Dodge (Buffered)",
    stamina: 6,
    accuracy: 0.6,
    delay: 1,
    defensive: true
  }
};

// ---------------- TURN LOGIC ----------------

function performMove(attacker, defender, moveKey) {
  const move = MOVES[moveKey];
  attacker.stamina -= move.stamina;
  attacker.delay += move.delay;

  let acc = move.accuracy || 1;

  if (attacker.buffs.accuracy) acc += attacker.buffs.accuracy.value;
  if (attacker.stamina < 30) acc -= 0.15;

  if (Math.random() < acc) {
    if (move.damage) {
      const parts = Object.keys(defender.limbs);
      const hitPart = parts[Math.floor(Math.random() * parts.length)];
      defender.limbs[hitPart] -= move.damage;

      log(`${attacker.name} lands a ${move.name} on the ${hitPart}.`);
      if (!defender.buffs.conceal) {
        log(injuryDesc(defender.limbs[hitPart], hitPart));
      }
    }

    if (move.rangeChange) {
      attacker.range = defender.range = move.rangeChange;
      log(`${attacker.name} forces the fight into the ${move.rangeChange}.`);
    }

    if (move.buff) {
      attacker.buffs[moveKey] = {
        value: move.buff.accuracy || null,
        turns: move.buff.turns,
        conceal: move.buff.conceal || false
      };
      log(`${attacker.name} looks composed and focused.`);
    }

  } else {
    log(`${attacker.name}'s ${move.name} misses.`);
    attacker.balance -= move.balanceRisk || 5;
  }
}

function enemyTurn() {
  if (enemy.delay > 0) {
    enemy.delay--;
    log("Opponent regains footing.");
    return;
  }

  const choices = ["jab", "cross", "focus"];
  const choice = choices[Math.floor(Math.random() * choices.length)];
  performMove(enemy, player, choice);
}

// ---------------- UI ----------------

function updateUI() {
  document.getElementById("status").innerText =
    `You: ${staminaDesc(player.stamina)} | Balance feels ${player.balance > 50 ? "stable" : "shaky"}`;

  document.getElementById("range").innerText =
    `Range: ${player.range}`;

  document.getElementById("stance").innerText =
    `Stance: ${player.stance}`;

  const elapsed = Math.floor((Date.now() - turnStart) / 1000);
  document.getElementById("timer").innerText =
    `Turn Timer: ${elapsed}s`;

  const actions = document.getElementById("actions");
  actions.innerHTML = "";

  Object.keys(MOVES).forEach(k => {
    const btn = document.createElement("button");
    btn.innerText = MOVES[k].name;
    btn.onclick = () => {
      const elapsed = (Date.now() - turnStart) / 1000;
      if (elapsed < 10) player.stamina -= 2; // evasive pacing
      if (elapsed > 20) player.delay += 1;   // careful pacing penalty

      performMove(player, enemy, k);
      enemyTurn();
      turnStart = Date.now();
      updateUI();
    };
    actions.appendChild(btn);
  });
}

log("The fight begins.");
updateUI();
</script>

</body>
</html>
